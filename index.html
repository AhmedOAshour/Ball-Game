<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <script src="lib/three.js"></script>
    <script src="lib/OrbitControls.js"></script>
    <script src="lib/GLTFLoader.js"></script>
    <script>
    var scene = new THREE.Scene();
    //(field of view in degrees, , near clipping plane, far clipping plane)
    var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight)
    document.body.appendChild(renderer.domElement);

var player;
const acc=0.1;
const turnrate=0.1;
var updownSpeed=0;
const maxSPeed=0.5;
var leftrightSpeed=0;
up=false;
down=false;
var array = {37: false, 38: false, 39: false, 40: false};
    //event listener for resizing app to window size
    window.addEventListener('resize', function()
    {
      var width = window.innerWidth;
      var height = window.innerHeight;
      renderer.setSize(width, height);
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
    });

    loader = new THREE.GLTFLoader();

    // Load a glTF resource
    loader.load(
    	// resource URL
    	'models/scene.gltf',
    	// called when the resource is loaded
      function ( gltf ) {
          //gltf.scene.scale.set(2,2,2) // scale here
          player = gltf.scene;
          player.scale.set(0.1,0.1,0.1);
          scene.add( player );
      },
    	// called while loading is progressing
    	function ( xhr ) {
    		console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );
    	},
    	// called when loading has errors
    	function ( error ) {
    		console.log( 'An error happened' );
    	}
    );

    controls = new THREE.OrbitControls(camera,renderer.domElement);
    camera.position.z = 10;
    var ambientLight = new THREE.AmbientLight(0xefebd8, 2);
    scene.add(ambientLight)


    cubeGeometry = new THREE.CubeGeometry(300, 300, 0);
      cubeMaterial = new THREE.MeshBasicMaterial( {color:'rgb(0,0,250)'} );
      cube = new THREE.Mesh( cubeGeometry, cubeMaterial );
      cube.translateZ(-10);


     scene.add(cube);


var render = function()
{
  renderer.render(scene, camera);
};




window.addEventListener ("keydown",event=>{





  if(event.keyCode in array)
  {
    array[event.keyCode]=true;
    if(array[38] && array[39]) //up and right
    {
      if(leftrightSpeed==maxSPeed || updownSpeed==maxSPeed)
      {
        return;
      }
      leftrightSpeed+=acc;
      updownSpeed+=turnrate;
    }
    if(array[38] && array[37]) //up and left
    {
      if(leftrightSpeed==maxSPeed || updownSpeed==maxSPeed)
      {
        return;
      }
      leftrightSpeed-=acc;
      updownSpeed+=turnrate;
    }
    if(array[40] && array[39]) //down and right
    {
      if(leftrightSpeed==maxSPeed || updownSpeed==maxSPeed)
      {
        return;
      }
      leftrightSpeed+=acc;
      updownSpeed-=turnrate;
    }
    if(array[37] && array[40]) //down and left
    {
      if(leftrightSpeed==maxSPeed || updownSpeed==maxSPeed)
      {
        return;
      }
      leftrightSpeed-=acc;
      updownSpeed-=turnrate;
    }
  }



  if(event.keyCode == '37')//right
  {
    if(leftrightSpeed==maxSPeed)
    {
      return;
    }

    leftrightSpeed-=acc;



  }


  if(event.keyCode == '39')//left
  {
    if(leftrightSpeed==maxSPeed)
    {
      return;
    }

    leftrightSpeed+=acc;



  }

   if(event.keyCode == '38')//up
  {
    if(updownSpeed==-maxSPeed)
    {
      return;
    }

  //  speed-=acc;
    updownSpeed+=turnrate;



  }

  if(event.keyCode == '40')//down
  {
    if(updownSpeed==maxSPeed)
    {
      return;
    }

  //  speed+=acc;
    updownSpeed-=turnrate;



  }



});

window.addEventListener ("keyup",event=>{
  if (event.keyCode in map) {
        map[event.keyCode] = false;
      }

});
var GameLoop = function()
{

  if(player)
    {

    player.translateX(leftrightSpeed);
    player.translateY(updownSpeed);

    //player.rotateY(speed);
    //player.rotateX(-diagonalSpeed);
     if(updownSpeed>0)
    {
      updownSpeed-=0.01;
    }
    else if(updownSpeed<0)
    {
      updownSpeed+=0.01;
    }
    if(leftrightSpeed>0)
    {

      leftrightSpeed-=0.01;
    }

    else if(leftrightSpeed<0)
    {
      leftrightSpeed+=0.01;
    }

    }

  requestAnimationFrame(GameLoop);

  render();
}
  GameLoop();
    </script>
  </body>
</html>
